<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Invoice Printing - Simple Mode</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .comparison-item { padding: 15px; border: 2px solid #ddd; border-radius: 8px; }
        .bl-style { border-color: #28a745; }
        .invoice-style { border-color: #dc3545; }
    </style>
</head>
<body>
    <h1>ðŸ§¾ Test Invoice Printing - Mode Simple</h1>
    <p>VÃ©rification que l'impression des factures fonctionne exactement comme celle des BL</p>
    
    <div class="test-section info">
        <h3>ðŸ”— URLs de test</h3>
        <p><strong>Production Factures:</strong> <a href="https://frontend-r9dthlwh4-tigdittgolf-9191s-projects.vercel.app/invoices/list" target="_blank">Liste des Factures</a></p>
        <p><strong>Production BL:</strong> <a href="https://frontend-r9dthlwh4-tigdittgolf-9191s-projects.vercel.app/delivery-notes/list" target="_blank">Liste des BL</a></p>
    </div>

    <div class="test-section">
        <h3>ðŸ”„ Comparaison du comportement d'impression</h3>
        <div class="comparison">
            <div class="comparison-item bl-style">
                <h4>ðŸ“‹ BL (RÃ©fÃ©rence - Comportement attendu)</h4>
                <p><strong>Comportement actuel des BL :</strong></p>
                <ul>
                    <li>âœ… Clic sur bouton PDF â†’ Ouvre directement dans nouvel onglet</li>
                    <li>âœ… Pas de tÃ©lÃ©chargement automatique</li>
                    <li>âœ… Utilisateur contrÃ´le impression/tÃ©lÃ©chargement depuis navigateur</li>
                    <li>âœ… Simple et efficace</li>
                </ul>
                <button onclick="testBLPrinting()">ðŸ§ª Tester BL</button>
            </div>
            
            <div class="comparison-item invoice-style">
                <h4>ðŸ§¾ Factures (Nouveau comportement)</h4>
                <p><strong>Comportement modifiÃ© des factures :</strong></p>
                <ul>
                    <li>âœ… Clic sur bouton PDF â†’ Ouvre directement dans nouvel onglet</li>
                    <li>âœ… Pas de tÃ©lÃ©chargement automatique</li>
                    <li>âœ… Utilisateur contrÃ´le impression/tÃ©lÃ©chargement depuis navigateur</li>
                    <li>âœ… Identique aux BL</li>
                </ul>
                <button onclick="testInvoicePrinting()">ðŸ§ª Tester Factures</button>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h3>ðŸ“‹ Instructions de test</h3>
        <ol>
            <li><strong>Tester les BL :</strong> Cliquez sur "Tester BL" pour ouvrir la liste des BL</li>
            <li><strong>Tester les Factures :</strong> Cliquez sur "Tester Factures" pour ouvrir la liste des factures</li>
            <li><strong>Comparer :</strong> VÃ©rifiez que les boutons PDF se comportent de la mÃªme maniÃ¨re</li>
            <li><strong>VÃ©rifier :</strong> 
                <ul>
                    <li>Pas de tÃ©lÃ©chargement automatique</li>
                    <li>PDF s'ouvre dans nouvel onglet</li>
                    <li>ContrÃ´les d'impression/tÃ©lÃ©chargement dans le navigateur</li>
                </ul>
            </li>
        </ol>
    </div>

    <div class="test-section">
        <h3>âœ… CritÃ¨res de rÃ©ussite</h3>
        <div id="test-results">
            <p><strong>Le test est rÃ©ussi si :</strong></p>
            <ul>
                <li>ðŸŽ¯ Les factures et BL ont le mÃªme comportement d'impression</li>
                <li>ðŸŽ¯ Aucun tÃ©lÃ©chargement automatique ne se dÃ©clenche</li>
                <li>ðŸŽ¯ Le PDF s'ouvre dans un nouvel onglet du navigateur</li>
                <li>ðŸŽ¯ L'utilisateur peut choisir d'imprimer ou tÃ©lÃ©charger depuis le navigateur</li>
                <li>ðŸŽ¯ Comportement cohÃ©rent sur mobile et desktop</li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <h3>ðŸ”§ Tests directs PDF</h3>
        <p>Tests directs des endpoints PDF (nÃ©cessite des IDs valides) :</p>
        <button onclick="testDirectBLPDF()">ðŸ“‹ Test BL PDF Direct</button>
        <button onclick="testDirectInvoicePDF()">ðŸ§¾ Test Facture PDF Direct</button>
        <div id="direct-test-results"></div>
    </div>

    <script>
        const PRODUCTION_URL = 'https://frontend-r9dthlwh4-tigdittgolf-9191s-projects.vercel.app';

        function testBLPrinting() {
            console.log('ðŸ§ª Testing BL printing behavior');
            window.open(`${PRODUCTION_URL}/delivery-notes/list`, '_blank');
        }

        function testInvoicePrinting() {
            console.log('ðŸ§ª Testing Invoice printing behavior');
            window.open(`${PRODUCTION_URL}/invoices/list`, '_blank');
        }

        function testDirectBLPDF() {
            console.log('ðŸ§ª Testing direct BL PDF');
            const resultDiv = document.getElementById('direct-test-results');
            resultDiv.innerHTML = '<p>ðŸ”„ Test BL PDF avec ID 5...</p>';
            
            // Test avec ID 5 (ID de fallback connu)
            const blPdfUrl = `${PRODUCTION_URL}/api/pdf/delivery-note/5`;
            console.log('ðŸ“„ Opening BL PDF:', blPdfUrl);
            
            window.open(blPdfUrl, '_blank');
            resultDiv.innerHTML = '<p>âœ… BL PDF ouvert dans nouvel onglet</p>';
        }

        function testDirectInvoicePDF() {
            console.log('ðŸ§ª Testing direct Invoice PDF');
            const resultDiv = document.getElementById('direct-test-results');
            resultDiv.innerHTML = '<p>ðŸ”„ Test Facture PDF avec ID 2...</p>';
            
            // Test avec ID 2 (basÃ© sur les donnÃ©es backend vues prÃ©cÃ©demment)
            const invoicePdfUrl = `${PRODUCTION_URL}/api/pdf/invoice/2`;
            console.log('ðŸ“„ Opening Invoice PDF:', invoicePdfUrl);
            
            window.open(invoicePdfUrl, '_blank');
            resultDiv.innerHTML = '<p>âœ… Facture PDF ouvert dans nouvel onglet</p>';
        }

        // Auto-log au chargement
        window.onload = function() {
            console.log('ðŸ§ª Invoice printing test page loaded');
            console.log('Production URL:', PRODUCTION_URL);
            console.log('Ready to test invoice printing behavior');
        };
    </script>
</body>
</html>