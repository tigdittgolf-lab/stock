<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Final - Bouton Modifier</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        .warning { background-color: #fff3cd; border-color: #ffeaa7; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        .result { margin-top: 10px; padding: 10px; background-color: #f8f9fa; border-radius: 3px; }
        a { color: #007bff; text-decoration: none; font-weight: bold; }
        a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <h1>ğŸ¯ Test Final - Bouton Modifier BL</h1>
    
    <div class="test-section success">
        <h2>âœ… Corrections ApportÃ©es</h2>
        <ul>
            <li>âœ… Configuration Vercel corrigÃ©e (API URL production)</li>
            <li>âœ… Frontend dÃ©ployÃ© sÃ©parÃ©ment</li>
            <li>âœ… Alias mis Ã  jour vers le bon dÃ©ploiement</li>
            <li>âœ… Code des boutons Modifier committÃ© et dÃ©ployÃ©</li>
        </ul>
    </div>

    <div class="test-section info">
        <h2>ğŸ”— URL Ã  Tester MAINTENANT</h2>
        <p><strong>URL Production (mise Ã  jour) :</strong></p>
        <p><a href="https://frontend-iota-six-72.vercel.app/delivery-notes/list" target="_blank">
            https://frontend-iota-six-72.vercel.app/delivery-notes/list
        </a></p>
        
        <p><strong>URL Directe (dernier dÃ©ploiement) :</strong></p>
        <p><a href="https://frontend-4b21s3lbq-tigdittgolf-9191s-projects.vercel.app/delivery-notes/list" target="_blank">
            https://frontend-4b21s3lbq-tigdittgolf-9191s-projects.vercel.app/delivery-notes/list
        </a></p>
    </div>

    <div class="test-section warning">
        <h2>âš ï¸ Instructions Importantes</h2>
        <ol>
            <li><strong>Videz votre cache navigateur :</strong>
                <ul>
                    <li>Chrome/Edge : Ctrl+Shift+R</li>
                    <li>Firefox : Ctrl+Shift+R</li>
                    <li>Safari : Cmd+Option+R</li>
                </ul>
            </li>
            <li><strong>Ou utilisez un onglet privÃ©/incognito</strong></li>
            <li><strong>Attendez 1-2 minutes</strong> pour la propagation DNS</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>ğŸ” Test Automatique</h2>
        <button onclick="testModifierButton()">Tester Bouton Modifier</button>
        <div id="testResult" class="result"></div>
    </div>

    <div class="test-section success">
        <h2>ğŸ¯ Ce que Vous Devriez Voir Maintenant</h2>
        <p><strong>Dans chaque ligne de BL, colonne "Actions" :</strong></p>
        <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; font-family: monospace;">
            [ğŸ‘ï¸ Voir] <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 3px;">[âœï¸ Modifier]</span> [ğŸ—‘ï¸ Supprimer] [ğŸ“„ BL Complet] [ğŸ“„ BL RÃ©duit] [ğŸ« Ticket]
        </div>
        
        <p><strong>Le bouton "âœï¸ Modifier" devrait :</strong></p>
        <ul>
            <li>ÃŠtre de couleur <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 3px;">VERTE</span></li>
            <li>ÃŠtre placÃ© entre "ğŸ‘ï¸ Voir" et "ğŸ—‘ï¸ Supprimer"</li>
            <li>Rediriger vers /delivery-notes/{id}/edit quand cliquÃ©</li>
        </ul>
    </div>

    <div class="test-section info">
        <h2>ğŸš€ Test Workflow Complet</h2>
        <ol>
            <li>Allez sur <a href="https://frontend-iota-six-72.vercel.app/delivery-notes/list" target="_blank">la liste des BL</a></li>
            <li>Cliquez sur "âœï¸ Modifier" d'un BL</li>
            <li>Vous devriez arriver sur la page de modification</li>
            <li>Modifiez quelque chose (client, date, article)</li>
            <li>Cliquez "Sauvegarder"</li>
            <li>Vous devriez revenir aux dÃ©tails du BL mis Ã  jour</li>
        </ol>
    </div>

    <script>
        async function testModifierButton() {
            const resultDiv = document.getElementById('testResult');
            resultDiv.innerHTML = 'ğŸ”„ Test en cours...';
            
            try {
                const urls = [
                    'https://frontend-iota-six-72.vercel.app/delivery-notes/list',
                    'https://frontend-4b21s3lbq-tigdittgolf-9191s-projects.vercel.app/delivery-notes/list'
                ];
                
                let results = [];
                
                for (const url of urls) {
                    try {
                        const response = await fetch(url);
                        const html = await response.text();
                        
                        const hasModifier = html.includes('âœï¸ Modifier');
                        const hasModifierStyle = html.includes('#28a745');
                        const hasModifierFunction = html.includes('/edit');
                        
                        results.push({
                            name: url.includes('frontend-iota-six-72') ? 'URL Production' : 'URL Directe',
                            url,
                            hasModifier,
                            hasModifierStyle,
                            hasModifierFunction,
                            status: response.status
                        });
                    } catch (e) {
                        results.push({
                            name: url.includes('frontend-iota-six-72') ? 'URL Production' : 'URL Directe',
                            url,
                            error: e.message
                        });
                    }
                }
                
                let resultHtml = '<h4>ğŸ“Š RÃ©sultats du Test :</h4>';
                
                results.forEach(result => {
                    if (result.error) {
                        resultHtml += `
                            <div class="error">
                                âŒ <strong>${result.name}:</strong> Erreur - ${result.error}
                            </div>
                        `;
                    } else {
                        const allGood = result.hasModifier && result.hasModifierStyle && result.hasModifierFunction;
                        const className = allGood ? 'success' : 'warning';
                        const icon = allGood ? 'âœ…' : 'âš ï¸';
                        
                        resultHtml += `
                            <div class="${className}">
                                ${icon} <strong>${result.name}:</strong><br>
                                - Bouton "âœï¸ Modifier": ${result.hasModifier ? 'âœ… TrouvÃ©' : 'âŒ Manquant'}<br>
                                - Style vert (#28a745): ${result.hasModifierStyle ? 'âœ… PrÃ©sent' : 'âŒ Manquant'}<br>
                                - Fonction /edit: ${result.hasModifierFunction ? 'âœ… PrÃ©sente' : 'âŒ Manquante'}<br>
                                - Status HTTP: ${result.status}<br>
                                ${allGood ? '<strong>ğŸ‰ TOUT FONCTIONNE !</strong>' : '<strong>âš ï¸ Videz votre cache ou attendez 1-2 minutes</strong>'}
                            </div>
                        `;
                    }
                });
                
                resultDiv.innerHTML = resultHtml;
                
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        âŒ <strong>ERREUR:</strong> ${error.message}
                    </div>
                `;
            }
        }

        // Auto-test aprÃ¨s 2 secondes
        setTimeout(() => {
            testModifierButton();
        }, 2000);
    </script>
</body>
</html>