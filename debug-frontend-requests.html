<!DOCTYPE html>
<html>
<head>
    <title>Debug Frontend Requests</title>
</head>
<body>
    <h1>üîç Debug des Requ√™tes Frontend</h1>
    <p>Ouvrez cette page, puis allez sur votre application. Les requ√™tes seront logg√©es ici.</p>
    <div id="logs"></div>
    
    <script>
        // Intercepter toutes les requ√™tes fetch
        const originalFetch = window.fetch;
        const logs = document.getElementById('logs');
        
        window.fetch = async function(...args) {
            const [url, options] = args;
            
            console.log('üîç FETCH REQUEST:', url, options);
            
            try {
                const response = await originalFetch(...args);
                const clonedResponse = response.clone();
                
                // Lire la r√©ponse
                const text = await clonedResponse.text();
                
                const logEntry = document.createElement('div');
                logEntry.style.border = '1px solid #ccc';
                logEntry.style.margin = '10px';
                logEntry.style.padding = '10px';
                
                logEntry.innerHTML = \`
                    <h3>üì° \${url}</h3>
                    <p><strong>Status:</strong> \${response.status}</p>
                    <p><strong>Content-Type:</strong> \${response.headers.get('content-type')}</p>
                    <p><strong>Response Length:</strong> \${text.length}</p>
                    <p><strong>First 100 chars:</strong> <code>\${text.substring(0, 100)}</code></p>
                    <details>
                        <summary>Full Response</summary>
                        <pre>\${text}</pre>
                    </details>
                \`;
                
                // V√©rifier si c'est du JSON valide
                try {
                    JSON.parse(text);
                    logEntry.style.backgroundColor = '#d4edda'; // Vert
                    logEntry.innerHTML += '<p>‚úÖ JSON valide</p>';
                } catch (jsonError) {
                    logEntry.style.backgroundColor = '#f8d7da'; // Rouge
                    logEntry.innerHTML += \`<p>‚ùå JSON invalide: \${jsonError.message}</p>\`;
                }
                
                logs.appendChild(logEntry);
                
                return response;
                
            } catch (error) {
                console.error('‚ùå Fetch error:', error);
                
                const logEntry = document.createElement('div');
                logEntry.style.border = '1px solid red';
                logEntry.style.margin = '10px';
                logEntry.style.padding = '10px';
                logEntry.style.backgroundColor = '#f8d7da';
                logEntry.innerHTML = \`
                    <h3>‚ùå \${url}</h3>
                    <p><strong>Error:</strong> \${error.message}</p>
                \`;
                logs.appendChild(logEntry);
                
                throw error;
            }
        };
        
        // Instructions
        const instructions = document.createElement('div');
        instructions.style.backgroundColor = '#d1ecf1';
        instructions.style.padding = '15px';
        instructions.style.margin = '10px';
        instructions.innerHTML = \`
            <h3>üìã Instructions:</h3>
            <ol>
                <li>Gardez cette page ouverte</li>
                <li>Allez sur <a href="http://localhost:3000" target="_blank">http://localhost:3000</a></li>
                <li>Connectez-vous et naviguez dans l'application</li>
                <li>Revenez ici pour voir les requ√™tes logg√©es</li>
                <li>Cherchez les entr√©es en rouge (JSON invalide)</li>
            </ol>
        \`;
        logs.appendChild(instructions);
    </script>
</body>
</html>